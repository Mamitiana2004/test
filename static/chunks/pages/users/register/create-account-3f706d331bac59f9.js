(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{503:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/register/create-account",function(){return t(7516)}])},7516:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return v}});var s=t(5893),n=t(2347),a=t.n(n),o=t(9008),i=t.n(o),c=t(1664),l=t.n(c),_=t(1163),u=t(5342),m=t(6776),p=t(4420),h=t(7294),g=t(607),d=t.n(g),f=t(8918),k=t(2013),j=t(1963),x=t(2879);function v(){let e=(0,_.useRouter)(),r=(0,h.useRef)(null),[t,n]=(0,h.useState)(""),o=(0,h.useRef)(null),[i,c]=(0,h.useState)(null),[g,v]=(0,h.useState)(""),w=(0,h.useRef)(null),[N,y]=(0,h.useState)(null),[b,C]=(0,h.useState)(""),[S,E]=(0,h.useState)(null),F=(0,h.useRef)(null),[T,R]=(0,h.useState)(!1),[U,P]=(0,h.useState)(!1),[I,B]=(0,h.useState)(!1),[O,M]=(0,h.useState)(!1),[A,X]=(0,h.useState)(!1),{user:J,setUser:V}=(0,h.useContext)(x.Z),Z=e=>{R(e.length>8),X(/[!@#$%^&*()_+{}\[\]:;<>,.?~\\-]/.test(e)),M(/\d/.test(e)),P(/[A-Z]/.test(e)),B(/[a-z]/.test(e))},q=async s=>{let n=await (0,j.Vt)(),a=sessionStorage.getItem("email_in_signup");try{let r=await fetch("".concat(k.F.apiBaseUrl,"/api/accounts/client/create-with-username/"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":n},body:JSON.stringify({email:a,username:t,password:s})});if(!await (0,j.vT)(t,s))throw Error("Failed to login after client creation");if(r.ok)fetch("".concat(k.F.apiBaseUrl,"/api/accounts/welcome-mail/"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":n},body:JSON.stringify({email:a})}).then(e=>e.json()).then(r=>{V({id:r.id,username:t}),sessionStorage.removeItem("email_in_signup"),e.push("/")}).catch(e=>{console.log(e)});else throw Error("Failed to create client")}catch(e){r.current.show({severity:"error",summary:"Error",detail:"An error occurred: "+e.message,life:5e3})}},z=async e=>{e.preventDefault();let r=!0;""==t.trim()&&(o.current.className=a().form_input_erreur,c("Username required"),r=!1),(g.length<8||""==g.trim())&&(w.current.className=a().form_input_erreur,y("Password required"),r=!1),b!=g&&(F.current.className=a().form_input_erreur,E("Password does not match"),r=!1),r&&await q(g)},D=(0,s.jsx)("span",{className:d().header_container,children:"Pick a new password"}),L=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.i,{}),(0,s.jsxs)("div",{className:d().check_wrapper,children:[(0,s.jsxs)("div",{className:d().check,children:[(0,s.jsx)(u.E,{alt:"check",imageClassName:d().check_logo,src:T?"/images/auth/check_logo.svg":"/images/auth/check_unknow.svg"}),(0,s.jsx)("span",{className:d().check_label,children:"Must be at least 8 characters"})]}),(0,s.jsxs)("div",{className:d().check,children:[(0,s.jsx)(u.E,{alt:"check",imageClassName:d().check_logo,src:U?"/images/auth/check_logo.svg":"/images/auth/check_unknow.svg"}),(0,s.jsx)("span",{className:d().check_label,children:"Must contain at least one uppercase character"})]}),(0,s.jsxs)("div",{className:d().check,children:[(0,s.jsx)(u.E,{alt:"check",imageClassName:d().check_logo,src:I?"/images/auth/check_logo.svg":"/images/auth/check_unknow.svg"}),(0,s.jsx)("span",{className:d().check_label,children:"Must contain at least one lowercase character"})]}),(0,s.jsxs)("div",{className:d().check,children:[(0,s.jsx)(u.E,{alt:"check",imageClassName:d().check_logo,src:O?"/images/auth/check_logo.svg":"/images/auth/check_unknow.svg"}),(0,s.jsx)("span",{className:d().check_label,children:"Must contain at least one number"})]}),(0,s.jsxs)("div",{className:d().check,children:[(0,s.jsx)(u.E,{alt:"check",imageClassName:d().check_logo,src:A?"/images/auth/check_logo.svg":"/images/auth/check_unknow.svg"}),(0,s.jsx)("span",{className:d().check_label,children:"Must contain at least one special character"})]})]})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:a().container,children:[(0,s.jsx)("div",{className:a().login_left,children:(0,s.jsx)(l(),{href:"/users",children:(0,s.jsx)(u.E,{src:"/images/logo-aftrip.png",alt:"logo",style:{width:"250px"}})})}),(0,s.jsxs)("div",{className:a().login_right,children:[(0,s.jsxs)("div",{className:a().login_title_container,children:[(0,s.jsx)("span",{className:a().login_title,children:"Create a new password"}),(0,s.jsx)("span",{className:a().login_title_label,children:"You are almost threre"})]}),(0,s.jsxs)("div",{className:a().content,children:[(0,s.jsxs)("form",{onSubmit:z,className:a().form,children:[(0,s.jsxs)("div",{className:a().form_group,children:[(0,s.jsxs)("div",{className:a().form_group_input,children:[(0,s.jsx)("span",{className:a().form_label,children:"Username"}),(0,s.jsx)("input",{ref:o,type:"text",className:a().form_input,placeholder:"Enter your username",value:t,onChange:e=>{o.current.className=a().form_input,n(e.target.value),c(null)}}),(0,s.jsx)(u.E,{style:null!=S?{display:"block"}:{display:"none"},className:a().form_erreur_image,src:"/images/auth/alert_circle.svg",alt:"!"})]}),(0,s.jsx)("span",{style:null!=i?{display:"block"}:{display:"none"},className:a().form_erreur,children:i})]}),(0,s.jsxs)("div",{className:a().form_group,children:[(0,s.jsxs)("div",{className:a().form_group_input,children:[(0,s.jsx)("span",{className:a().form_label,children:"Password"}),(0,s.jsx)(m.r,{ref:w,inputClassName:a().form_input_password,className:a().form_input_password_container,placeholder:"Enter your pasword",value:g,toggleMask:!0,header:D,footer:L,onChange:e=>{w.current.className=a().form_input,v(e.target.value),y(null),Z(e.target.value)}})]}),(0,s.jsx)("span",{style:null!=N?{display:"block"}:{display:"none"},className:a().form_erreur,children:N})]}),(0,s.jsxs)("div",{className:a().form_group,children:[(0,s.jsxs)("div",{className:a().form_group_input,children:[(0,s.jsx)("span",{className:a().form_label,children:"Confirm password"}),(0,s.jsx)("input",{ref:F,type:"password",className:a().form_input,placeholder:"Confirm your pasword",value:b,onChange:e=>{F.current.className=a().form_input,C(e.target.value),E(null)}}),(0,s.jsx)(u.E,{style:null!=S?{display:"block"}:{display:"none"},className:a().form_erreur_image,src:"/images/auth/alert_circle.svg",alt:"!"})]}),(0,s.jsx)("span",{style:null!=S?{display:"block"}:{display:"none"},className:a().form_erreur,children:S})]}),(0,s.jsx)("div",{className:a().button_group,children:(0,s.jsx)("button",{type:"submit",className:a().login_button,children:"Register"})})]}),(0,s.jsx)("div",{className:a().register_component,children:(0,s.jsxs)(l(),{className:a().register_link,href:"/users/login",children:[(0,s.jsx)("i",{className:"pi pi-angle-left"})," Back to Login"]})})]})]}),(0,s.jsxs)("div",{className:a().footer,children:[(0,s.jsx)("span",{children:"Copyright 2024 - All rights reserved"}),(0,s.jsx)(l(),{style:{color:"#000"},href:"/users/privatePolicy",children:"Pivate policy"})]})]}),(0,s.jsx)(p.F,{ref:r})]})}v.getLayout=function(e){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{children:(0,s.jsx)("title",{children:"Create an account"})}),e]})}},2013:function(e,r,t){"use strict";t.d(r,{F:function(){return s}});let s={apiBaseUrl:"http://192.168.88.37:8000",adminUrl:"/admin"}},1963:function(e,r,t){"use strict";t.d(r,{Vt:function(){return o},vT:function(){return a}});var s=t(1955),n=t(2013);let a=async(e,r)=>{let t="".concat(n.F.apiBaseUrl,"/api/token/"),a=await o();try{let n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":a},body:JSON.stringify({username:e,password:r})});if(!n.ok)throw Error("HTTP error! Status: ".concat(n.status));let o=await n.json();return console.log(o),o.access&&s.Z.set("access_token",o.access,{expires:7,secure:!0,sameSite:"strict"}),o.refresh&&s.Z.set("refresh_token",o.refresh,{expires:30,secure:!0,sameSite:"strict"}),o}catch(e){throw console.error("Error fetching data:",e),e}},o=async()=>{try{let e=await fetch("".concat(n.F.apiBaseUrl,"/api/get-csrf-token-direct/"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to get CSRF token");return(await e.json()).csrfToken}catch(e){throw console.error("Error fetching CSRF token:",e.message),e}}},607:function(e){e.exports={header_container:"PasswordInput_header_container__g8U4R",check_wrapper:"PasswordInput_check_wrapper__foqj1",check:"PasswordInput_check__U9M89",check_logo:"PasswordInput_check_logo__p6hru",check_label:"PasswordInput_check_label__Qp0Vf"}},2347:function(e){e.exports={container:"login_container__QxMsj",footer:"login_footer__7U2NE",separateur_container:"login_separateur_container__YG2w4",separateur:"login_separateur__rTk29",login_left:"login_login_left__u8XC8",login_right:"login_login_right__AykJp",login_title:"login_login_title__GuFSk",login_title_container:"login_login_title_container__qjuVs",login_title_label:"login_login_title_label__Eh0y7",logo:"login_logo__1jLz5",content:"login_content__QBi7I",form:"login_form__Y_Qx_",form_group:"login_form_group__MnWGC",form_group_input:"login_form_group_input__fp4La",form_label:"login_form_label__e4Jy5",form_input:"login_form_input__HLtl0",form_input_password_container:"login_form_input_password_container__VRloI",form_input_password:"login_form_input_password__ufy9s",form_erreur_image:"login_form_erreur_image__6v8T_",form_erreur:"login_form_erreur__hoZt_",form_input_erreur:"login_form_input_erreur__i35mE",link_forgot_container:"login_link_forgot_container__FK0Wl",link_forgot:"login_link_forgot__41zly",button_group:"login_button_group__qOnVS",login_button:"login_login_button__trQin",resend_button:"login_resend_button__bYjEk",timer:"login_timer__Br_81",register_component:"login_register_component__X94J0",register_link:"login_register_link__sK644"}},1955:function(e,r,t){"use strict";/*! js-cookie v3.0.5 | MIT */function s(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)e[s]=t[s]}return e}t.d(r,{Z:function(){return n}});var n=function e(r,t){function n(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=s({},t,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var i in a)a[i]&&(o+="; "+i,!0!==a[i]&&(o+="="+a[i].split(";")[0]));return document.cookie=e+"="+r.write(n,e)+o}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],s={},n=0;n<t.length;n++){var a=t[n].split("="),o=a.slice(1).join("=");try{var i=decodeURIComponent(a[0]);if(s[i]=r.read(o,i),e===i)break}catch(e){}}return e?s[e]:s}},remove:function(e,r){n(e,"",s({},r,{expires:-1}))},withAttributes:function(r){return e(this.converter,s({},this.attributes,r))},withConverter:function(r){return e(s({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[5342,4420,6383,2888,9774,179],function(){return e(e.s=503)}),_N_E=e.O()}]);