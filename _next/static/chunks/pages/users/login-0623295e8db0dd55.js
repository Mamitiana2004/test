(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9861],{5958:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/login",function(){return n(4376)}])},4376:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return x}});var t=n(5893),o=n(2879),s=n(2347),i=n.n(s),a=n(2013);n(1963);var l=n(1794),c=n(1955),u=n(9008),_=n.n(u),p=n(1664),f=n.n(p),m=n(1163),g=n(5342),d=n(4420),h=n(7294);function x(){let e=(0,m.useRouter)(),r=(0,h.useRef)(null),{user:n,setUser:s}=(0,h.useContext)(o.Z),[u,_]=(0,h.useState)(""),p=(0,h.useRef)(null),[x,v]=(0,h.useState)(""),j=(0,h.useRef)(null),[y,w]=(0,h.useState)(null),[N,C]=(0,h.useState)(null),b=async n=>{n.preventDefault();let t=!0;""!=u.trim()&&(0,l.s)(u)||(p.current.className=i().form_input_erreur,w("Email required"),t=!1),""==x.trim()&&(j.current.className=i().form_input_erreur,C("Password required"),t=!1),t&&fetch("".concat(a.F.apiBaseUrl,"/api/accounts/client/login/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:x})}).then(e=>{if(e.ok)return e.json();{let n;404==e.status&&(n="Email unknow"),401==e.status&&(n="Wrong password"),r.current.show({severity:"error",summary:"Error",detail:n,life:5e3})}}).then(r=>{r.access&&c.Z.set("access_token",r.access,{expires:7,secure:!0,sameSite:"strict"}),r.refresh&&c.Z.set("refresh_token",r.refresh,{expires:30,secure:!0,sameSite:"strict"}),s({username:r.username,id:r.id,userImage:r.image}),e.push("/users")}).catch(e=>{r.current.show({severity:"error",summary:"Error",detail:"Erreur de connexion",life:5e3}),console.log(e)})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:i().container,children:[(0,t.jsx)("div",{className:i().login_left,children:(0,t.jsx)(f(),{href:"/users",children:(0,t.jsx)(g.E,{src:"/images/logo-aftrip.png",alt:"logo",style:{width:"250px"}})})}),(0,t.jsxs)("div",{className:i().login_right,children:[(0,t.jsxs)("div",{className:i().login_title_container,children:[(0,t.jsx)("span",{className:i().login_title,children:"Login"}),(0,t.jsx)("span",{className:i().login_title_label,children:"Welcome back! Please enter your details"})]}),(0,t.jsxs)("div",{className:i().separateur_container,children:[(0,t.jsx)("div",{className:i().separateur}),(0,t.jsx)("span",{children:"or"}),(0,t.jsx)("div",{className:i().separateur})]}),(0,t.jsxs)("div",{className:i().content,children:[(0,t.jsxs)("form",{onSubmit:b,className:i().form,children:[(0,t.jsxs)("div",{className:i().form_group,children:[(0,t.jsxs)("div",{className:i().form_group_input,children:[(0,t.jsx)("span",{className:i().form_label,children:"Email"}),(0,t.jsx)("input",{ref:p,type:"email",autoFocus:!0,className:i().form_input,placeholder:"Enter your email",value:u,onChange:e=>{p.current.className=i().form_input,_(e.target.value),w(null)}}),(0,t.jsx)(g.E,{style:null!=y?{display:"block"}:{display:"none"},className:i().form_erreur_image,src:"/images/auth/alert_circle.svg",alt:"!"})]}),(0,t.jsx)("span",{style:null!=y?{display:"block"}:{display:"none"},className:i().form_erreur,children:y})]}),(0,t.jsxs)("div",{className:i().form_group,children:[(0,t.jsxs)("div",{className:i().form_group_input,children:[(0,t.jsx)("span",{className:i().form_label,children:"Password"}),(0,t.jsx)("input",{ref:j,type:"password",className:i().form_input,placeholder:"Enter your pasword",value:x,onChange:e=>{j.current.className=i().form_input,v(e.target.value),C(null)}}),(0,t.jsx)(g.E,{style:null!=N?{display:"block"}:{display:"none"},className:i().form_erreur_image,src:"/images/auth/alert_circle.svg",alt:"!"})]}),(0,t.jsx)("span",{style:null!=N?{display:"block"}:{display:"none"},className:i().form_erreur,children:N})]}),(0,t.jsx)("div",{className:i().link_forgot_container,children:(0,t.jsx)(f(),{href:"/users/forgot",className:i().link_forgot,children:"Forgot password?"})}),(0,t.jsx)("div",{className:i().button_group,children:(0,t.jsx)("button",{type:"submit",className:i().login_button,children:"Sign in"})})]}),(0,t.jsxs)("div",{className:i().register_component,children:[(0,t.jsx)("span",{className:i().register_label,children:"Don't have an account ?"}),(0,t.jsx)(f(),{className:i().register_link,href:"/users/register",children:"Sign up"})]})]})]}),(0,t.jsxs)("div",{className:i().footer,children:[(0,t.jsx)("span",{children:"Copyright 2024 - All rights reserved"}),(0,t.jsx)(f(),{style:{color:"#000"},href:"/users/privatePolicy",children:"Pivate policy"})]})]}),(0,t.jsx)(d.F,{ref:r})]})}x.getLayout=function(e){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_(),{children:(0,t.jsx)("title",{children:"Login"})}),e]})}},2013:function(e,r,n){"use strict";n.d(r,{F:function(){return t}});let t={apiBaseUrl:"http://192.168.88.37:8000",adminUrl:"/admin"}},1963:function(e,r,n){"use strict";n.d(r,{Vt:function(){return i},vT:function(){return s}});var t=n(1955),o=n(2013);let s=async(e,r)=>{let n="".concat(o.F.apiBaseUrl,"/api/token/"),s=await i();try{let o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":s},body:JSON.stringify({username:e,password:r})});if(!o.ok)throw Error("HTTP error! Status: ".concat(o.status));let i=await o.json();return console.log(i),i.access&&t.Z.set("access_token",i.access,{expires:7,secure:!0,sameSite:"strict"}),i.refresh&&t.Z.set("refresh_token",i.refresh,{expires:30,secure:!0,sameSite:"strict"}),i}catch(e){throw console.error("Error fetching data:",e),e}},i=async()=>{try{let e=await fetch("".concat(o.F.apiBaseUrl,"/api/get-csrf-token-direct/"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to get CSRF token");return(await e.json()).csrfToken}catch(e){throw console.error("Error fetching CSRF token:",e.message),e}}},1794:function(e,r,n){"use strict";n.d(r,{s:function(){return t}});let t=e=>/^[\w\.-]+@[a-zA-Z\d\.-]+\.[a-zA-Z]{2,}$/.test(e)},2347:function(e){e.exports={container:"login_container__QxMsj",footer:"login_footer__7U2NE",separateur_container:"login_separateur_container__YG2w4",separateur:"login_separateur__rTk29",login_left:"login_login_left__u8XC8",login_right:"login_login_right__AykJp",login_title:"login_login_title__GuFSk",login_title_container:"login_login_title_container__qjuVs",login_title_label:"login_login_title_label__Eh0y7",logo:"login_logo__1jLz5",content:"login_content__QBi7I",form:"login_form__Y_Qx_",form_group:"login_form_group__MnWGC",form_group_input:"login_form_group_input__fp4La",form_label:"login_form_label__e4Jy5",form_input:"login_form_input__HLtl0",form_input_password_container:"login_form_input_password_container__VRloI",form_input_password:"login_form_input_password__ufy9s",form_erreur_image:"login_form_erreur_image__6v8T_",form_erreur:"login_form_erreur__hoZt_",form_input_erreur:"login_form_input_erreur__i35mE",link_forgot_container:"login_link_forgot_container__FK0Wl",link_forgot:"login_link_forgot__41zly",button_group:"login_button_group__qOnVS",login_button:"login_login_button__trQin",resend_button:"login_resend_button__bYjEk",timer:"login_timer__Br_81",register_component:"login_register_component__X94J0",register_link:"login_register_link__sK644"}},9513:function(e,r,n){"use strict";n.d(r,{n:function(){return i}});var t=n(7294),o=n(4320);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var i=t.memo(t.forwardRef(function(e,r){var n=o.A.getPTI(e);return t.createElement("svg",s({ref:r,width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),t.createElement("path",{d:"M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z",fill:"currentColor"}))}));i.displayName="CheckIcon"},1955:function(e,r,n){"use strict";/*! js-cookie v3.0.5 | MIT */function t(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)e[t]=n[t]}return e}n.d(r,{Z:function(){return o}});var o=function e(r,n){function o(e,o,s){if("undefined"!=typeof document){"number"==typeof(s=t({},n,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in s)s[a]&&(i+="; "+a,!0!==s[a]&&(i+="="+s[a].split(";")[0]));return document.cookie=e+"="+r.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],t={},o=0;o<n.length;o++){var s=n[o].split("="),i=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(t[a]=r.read(i,a),e===a)break}catch(e){}}return e?t[e]:t}},remove:function(e,r){o(e,"",t({},r,{expires:-1}))},withAttributes:function(r){return e(this.converter,t({},this.attributes,r))},withConverter:function(r){return e(t({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[5342,4420,2888,9774,179],function(){return e(e.s=5958)}),_N_E=e.O()}]);